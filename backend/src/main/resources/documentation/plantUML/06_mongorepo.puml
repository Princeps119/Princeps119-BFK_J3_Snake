@startuml
title MongoRepo â€“ Repository Layer

class MongoRepo <<singleton>> {
  - {static} SECRET_PATH : Path = "/run/secrets/MONGO_URI_FILE"
  - {static} instance : MongoRepo
  - userDB : MongoDatabase
  - MongoRepo()
  + {static} getInstance() : MongoRepo
  + getUserDB() : MongoDatabase
  + getUserCollection(collectionName : String) : MongoCollection<Document>
  - createExampleUser() : void
}

MongoRepo ..> MongoDatabase : manages
MongoRepo ..> MongoCollection : returns
MongoRepo ..> Document : inserts example user
MongoRepo ..> data.TokenData : creates for example user
MongoRepo ..> services.TokenEncrypter : encrypt email

note right of MongoRepo
Initialisiert DB-Verbindung:
- URI aus Docker Secret (/run/secrets/MONGO_URI_FILE)
- Fallback: lokale URI (localhost:27018, snake_userData)
Erstellt Collection "users" mit Unique-Index auf mail
Legt Beispiel-User an (SHA-256 Hash des Passworts)
end note
@enduml